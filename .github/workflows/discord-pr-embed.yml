# name: Discord PR Notifications

# on:
#   pull_request:
#     types: [opened, closed]  # triggers on PR creation and PR close

# jobs:
#   discord-pr:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Send Discord PR Notification
#         uses: actions/github-script@v7
#         with:
#           github-token: ${{ secrets.GITHUB_TOKEN }}
#           script: |
#             const axios = require('axios');
#             const webhookUrl = '${{ secrets.DISCORD_WEBHOOK_PR }}';

#             // Only run on pull_request events
#             if (github.event_name !== 'pull_request') return;

#             const pr = github.event.pull_request;
#             const action = github.event.action;

#             // Helper function to send Discord embed
#             async function sendEmbed(embed) {
#               try {
#                 await axios.post(webhookUrl, { embeds: [embed] });
#                 console.log("Discord message sent successfully");
#               } catch (err) {
#                 console.error("Discord webhook failed:", err.message);
#               }
#             }

#             // PR Created
#             if (action === 'opened') {
#               const embed = {
#                 title: `üì¨ PR Created: ${pr.title}`,
#                 url: pr.html_url,
#                 color: 0x00ff00,
#                 author: { name: pr.user.login, icon_url: pr.user.avatar_url },
#                 fields: [
#                   { name: 'Branch', value: pr.head.ref, inline: true },
#                   { name: 'Base', value: pr.base.ref, inline: true }
#                 ],
#                 timestamp: new Date().toISOString()
#               };
#               await sendEmbed(embed);
#             }

#             // PR Merged
#             if (action === 'closed' && pr.merged) {
#               const embed = {
#                 title: `‚úÖ PR Merged: ${pr.title}`,
#                 url: pr.html_url,
#                 color: 0x0000ff,
#                 author: { name: pr.user.login, icon_url: pr.user.avatar_url },
#                 fields: [
#                   { name: 'Merged into', value: pr.base.ref, inline: true },
#                   { name: 'Branch', value: pr.head.ref, inline: true }
#                 ],
#                 timestamp: new Date().toISOString()
#               };
#               await sendEmbed(embed);
#             }

#             // PR Closed without merge
#             if (action === 'closed' && !pr.merged) {
#               const embed = {
#                 title: `‚ùå PR Closed: ${pr.title}`,
#                 url: pr.html_url,
#                 color: 0xff0000,
#                 author: { name: pr.user.login, icon_url: pr.user.avatar_url },
#                 fields: [
#                   { name: 'Branch', value: pr.head.ref, inline: true },
#                   { name: 'Base', value: pr.base.ref, inline: true }
#                 ],
#                 timestamp: new Date().toISOString()
#               };
#               await sendEmbed(embed);
#             }
